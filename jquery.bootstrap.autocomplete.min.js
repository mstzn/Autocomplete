(function(e){e.fn.BootstrapComplete=function(t){var n={};var r={requestURL:"",trigger:"@",minLength:2,cache:true,method:"POST"};var i=this;var s=e(this);var o="";i.settings={};var u=function(){i.settings=e.extend({},r,t);i.el=s;i.settings.minLength++;i.el.autocomplete({minLength:i.settings.minLength,source:function(t,r){t.term;if(i.settings.cache){if(o in n){r(n[o]);return}}var s=i.el[0].selectionEnd;for(var u=s;u>=0;u--){var a=i.el.val().substr(u-1,1);if(a==" "){i.el.autocomplete("close");break}if(a==i.settings.trigger){o=i.el.val().substr(u-1,s-u+1);break}}if(e.trim(o).length>=i.settings.minLength&&o.substr(0,1)==i.settings.trigger){var t=e.ajax({type:i.settings.method,url:i.settings.requestURL,data:{term:o},dataType:"json"});t.done(function(e){if(i.settings.cache){n[o]=e}r(e)});t.fail(function(e,t){console.log("Fail! Desc:"+t)})}},focus:function(e,t){return false},select:function(e,t){var n=i.el[0].selectionEnd;for(var r=n;r>=0;r--){var s=i.el.val().substr(r-1,1);if(s==" "){i.el.autocomplete("close");break}if(s==i.settings.trigger){i.el.val(i.el.val().slice(0,r)+t.item.value+" "+i.el.val().slice(n));break}}var u=t.item.value.length-o.length+2;i.selectPos(i.el[0],n+u,n+u);return false}}).data("ui-autocomplete")._renderItem=function(t,n){return e("<li>").append("<a><img src='"+n.image+"' class='img-thumbnail' style='height:20px; width:20px; margin-right:5px;' />"+n.label+"</a>").appendTo(t)}};i.selectPos=function(e,t,n){e.focus();if(e.setSelectionRange)e.setSelectionRange(t,n);else if(e.createTextRange){e=e.createTextRange();e.collapse(true);e.moveEnd("",n);e.moveStart("",t);e.select()}};u()}})(jQuery)
